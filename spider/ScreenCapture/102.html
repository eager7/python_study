<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="renderer" content="webkit">
    <title></title>
    <link rel="icon shortcut" href="/static/favicon.ico">
    <link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/semantic-ui/2.1.8/semantic.min.css">
    <link rel="stylesheet" type="text/css" href="/static/editormd/css/editormd.min.css"/>
    <link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/codemirror/5.12.0/codemirror.min.css"/>
    <link rel="stylesheet" type="text/css" href="/static/css/style.css"/>
    <script src="//cdn.bootcss.com/require.js/2.1.22/require.min.js"></script>
<script src="/static/js/lib/config.js"></script>
</head>
<body>
<div class="wrapper">
    <div class="ui main menu">
    <div class="header item" onclick="window.open('/','_self')">
        <em>ElvizLai's Blog</em>
    </div>
    <a class="item active" href="/">
        <i class="icon home"></i>Home
    </a>
    <a class="item " href="/archives">
        <i class="icon calendar"></i>Archives
    </a>
    <a class="item " href="/about">
        <i class="icon qrcode"></i>About
    </a>
    
</div>
    <div class="ui stackable grid" style="padding-bottom: 48px;width: 100%">
        <div class="sixteen wide column segment">
            
            
            <div class="ui raised segment" style="margin-left: 2%">
                <a class="ui teal ribbon label">2016-05-29</a>
                <a style="font-size: x-large;font-weight: 800;vertical-align: middle" href="/topic/41">nsqçš„dockerä¹‹æ—…</a>
                <div class="ui divider"></div>
                <div class="editormd-view" id="41">
                    <div class="abstract">
                        <p>NSQæ˜¯ç”¨goè¯­è¨€å¼€å‘çš„ä¸€æ¬¾æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæœ¬æ–‡è®°å½•äº†å€ŸåŠ©dockerå¿«é€Ÿæ­å»ºå¼€å‘è¿‡ç¨‹ã€‚</p>
<p>1.docker networkåˆ›å»º<br><code>docker network create nsq</code></p>
<p>2.è¿è¡Œdockerå®¹å™¨nsqlookupd<br><code>docker run -d --net=nsq -p 4160:4160 -p 4161:4161 --name nsqlookupd nsqio/nsq /nsqlookupd</code></p>
<p>3.è¿è¡Œdockerå®¹å™¨nsqd<br><code>docker run -d --net=nsq -p 4150:4150 -p 4151:4151 --name nsqd nsqio/nsq /nsqd --broadcast-address=192.168.99.111 --lookupd-tcp-address=nsqlookupd:4160</code></p>
<p>å…¶ä¸­ broadcast-address æ˜¯å…¬ç½‘åœ°å€</p>
<p>4.è¿è¡Œdockerå®¹å™¨nsqadmin<br><code>docker run -d --net=nsq --name nsqadmin -p 4171:4171 nsqio/nsq /nsqadmin  --lookupd-http-address=nsqlookupd:4161</code></p>
<p>ç„¶åå°±å¯ä»¥é€šè¿‡:4171æ¥è®¿é—®nsqadminå•¦</p>
<p>èµ¶ç´§å‘ä¸¤æ¡æ¶ˆæ¯çœ‹çœ‹å§</p>
<pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums"><li class="L0"><code><span class="pln">    curl </span><span class="pun">-</span><span class="pln">d </span><span class="str">'hello world 1'</span><span class="pln"> </span><span class="str">'http://192.168.99.111:4151/put?topic=test'</span></code></li><li class="L1"><code><span class="pln">    curl </span><span class="pun">-</span><span class="pln">d </span><span class="str">'hello world 2'</span><span class="pln"> </span><span class="str">'http://192.168.99.111:4151/put?topic=test'</span></code></li></ol></pre>
                    </div>
                </div>
                <div class="ui divider"></div>
                
                <a class="ui tiny tag label" style="margin: 2px 5px 2px 5px" href="/tag/go">go</a>
                
                <a class="ui tiny tag label" style="margin: 2px 5px 2px 5px" href="/tag/nsq">nsq</a>
                
            </div>
            
            <div class="ui raised segment" style="margin-left: 2%">
                <a class="ui teal ribbon label">2016-04-26</a>
                <a style="font-size: x-large;font-weight: 800;vertical-align: middle" href="/topic/40">Macä¸‹ä¸ºæ ‘è“æ´¾3å®‰è£…Ubuntu Mate 16.04</a>
                <div class="ui divider"></div>
                <div class="editormd-view" id="40">
                    <div class="abstract">
                        <p>åº”ç”¨äºæ ‘è“æ´¾3çš„Ubuntu Mate 16.04å‡ºæ¥å•¦ï¼Œèµ¶ç´§æŠŠå®˜æ–¹è‡ªå¸¦çš„raspbianæ¢æ‰å§ğŸ˜Š<br>
                    </div>
                </div>
                <div class="ui divider"></div>
                
                <a class="ui tiny tag label" style="margin: 2px 5px 2px 5px" href="/tag/%e6%9c%aa%e5%88%86%e7%b1%bb">æœªåˆ†ç±»</a>
                
            </div>
            
            <div class="ui raised segment" style="margin-left: 2%">
                <a class="ui teal ribbon label">2016-04-13</a>
                <a style="font-size: x-large;font-weight: 800;vertical-align: middle" href="/topic/39">go sqlä¹‹Query</a>
                <div class="ui divider"></div>
                <div class="editormd-view" id="39">
                    <div class="abstract">
                        <p>1ã€ä½¿ç”¨txæ—¶ï¼Œrowsæ²¡æœ‰closeæ˜¯å¦ä¼šå¯¼è‡´æœ‰æœªè¢«é‡Šæ”¾çš„æ•°æ®åº“è¿æ¥ï¼Ÿ<br>å½“æœ€åæ‰§è¡Œtx.Commit()æˆ–tx.Rollback()æ—¶ï¼Œç›¸åº”çš„è¿æ¥ä¼šè¢«å…³é—­ã€‚ä¸ä¼šå­˜åœ¨æœªè¢«é‡Šæ”¾çš„æƒ…å†µã€‚ä½†ä»ç„¶å»ºè®®å…»æˆå…³é—­çš„å¥½ä¹ æƒ¯ã€‚
</p><p>2ã€rows.Err()çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ<br>Err()çš„ç›¸å…³æ³¨é‡Šæ˜¯è¿™æ ·å†™çš„ï¼šErr returns the error, if any, that was encountered during iteration.<br>ä½†è¯·æ³¨æ„ï¼Œè¿™äº›é”™è¯¯ï¼Œä»…ä¸è¿­ä»£è¿‡ç¨‹ä¸­rowsé”™è¯¯ç›¸å…³ï¼Œæ¯”å¦‚åœ¨ä¸‹ä¸€ä¸ªNext()æ—¶ï¼Œæ•°æ®åº“å‡ºé—®é¢˜äº†ï¼Œæˆ–è€…txå·²ç»ç»“æŸï¼Œtxå‘ç”Ÿé”™è¯¯ã€‚<br>ä¸Scan()å¤„äº§ç”Ÿçš„é”™è¯¯æ²¡æœ‰ä»»ä½•å…³è”ã€‚<br>æ‰€ä»¥ï¼Œè¿™ä¸¤éƒ¨åˆ†é”™è¯¯åº”è¯¥å•ç‹¬åˆ†åˆ«å¤„ç†ã€‚
</p><p>3ã€rows.Next()ä¸­è¿›è¡Œtx.Exec(update)æ“ä½œï¼Ÿ<br>å¦‚æœrows.Next()æ˜¯ç”±txå‘èµ·çš„ï¼Œupdateè¯­å¥ä¸­åŒ…å«$1è½¬è¯‘ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚æ­¤æ—¶updateç›¸å…³ï¼Œåº”è¯¥æ”¾åˆ°Nextå¾ªç¯ä¹‹å¤–è¿›è¡Œã€‚<br>å¦‚æœè¿›è¡Œæ— è½¬ç§»updateï¼Œåˆ™å…è®¸è¯¥æ“ä½œã€‚<br>å¦‚æœrows.Next()æ˜¯æœ‰DBå‘èµ·çš„ï¼Œåˆ™ä»¥ä¸Šæ“ä½œéƒ½æ˜¯å…è®¸çš„ã€‚
</p>
                    </div>
                </div>
                <div class="ui divider"></div>
                
                <a class="ui tiny tag label" style="margin: 2px 5px 2px 5px" href="/tag/go">go</a>
                
                <a class="ui tiny tag label" style="margin: 2px 5px 2px 5px" href="/tag/sql">sql</a>
                
            </div>
            
            <div class="ui raised segment" style="margin-left: 2%">
                <a class="ui teal ribbon label">2016-04-07</a>
                <a style="font-size: x-large;font-weight: 800;vertical-align: middle" href="/topic/36">[goåŸºç¡€æ€»ç»“]â€”â€”bytesåŒ…</a>
                <div class="ui divider"></div>
                <div class="editormd-view" id="36">
                    <div class="abstract">
                        <p>æ€»ç»“ä¸‹bytesåŒ…ä¸­çš„å„æ“ä½œã€‚<br>
                    </div>
                </div>
                <div class="ui divider"></div>
                
                <a class="ui tiny tag label" style="margin: 2px 5px 2px 5px" href="/tag/go">go</a>
                
            </div>
            
            <div class="ui raised segment" style="margin-left: 2%">
                <a class="ui teal ribbon label">2016-04-03</a>
                <a style="font-size: x-large;font-weight: 800;vertical-align: middle" href="/topic/35">grpc over tls</a>
                <div class="ui divider"></div>
                <div class="editormd-view" id="35">
                    <div class="abstract">
                        <p>grpcæœ¬èº«å¯ä»¥å·¥ä½œäºå¸¸è§„çš„tcpæ¨¡å¼ï¼Œä½†å‡ºäºæ•°æ®äº¤æ¢çš„ä¿å¯†æ€§åŠå®‰å…¨è§’åº¦è€ƒè™‘ï¼Œåœ¨å…¶ä¸ŠåŠ ä¸€å±‚tlsä¹Ÿæ˜¯æå¥½çš„ã€‚</p>

                    </div>
                </div>
                <div class="ui divider"></div>
                
                <a class="ui tiny tag label" style="margin: 2px 5px 2px 5px" href="/tag/go">go</a>
                
                <a class="ui tiny tag label" style="margin: 2px 5px 2px 5px" href="/tag/grpc">grpc</a>
                
            </div>
            
            <div class="ui raised segment" style="margin-left: 2%">
                <a class="ui teal ribbon label">2016-04-02</a>
                <a style="font-size: x-large;font-weight: 800;vertical-align: middle" href="/topic/34">go ç¼–è¯‘æ—¶æ³¨å…¥</a>
                <div class="ui divider"></div>
                <div class="editormd-view" id="34">
                    <div class="abstract">
                        <pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-go"><span class="kwd">package</span><span class="pln"> main</span></code></li><li class="L1"><code class="lang-go"></code></li><li class="L2"><code class="lang-go"><span class="kwd">import</span><span class="pln"> </span><span class="pun">(</span></code></li><li class="L3"><code class="lang-go"><span class="pln">    </span><span class="str">"fmt"</span></code></li><li class="L4"><code class="lang-go"><span class="pun">)</span></code></li><li class="L5"><code class="lang-go"></code></li><li class="L6"><code class="lang-go"><span class="kwd">var</span><span class="pln"> DEBUG </span><span class="pun">=</span><span class="pln"> </span><span class="str">"NO"</span></code></li><li class="L7"><code class="lang-go"></code></li><li class="L8"><code class="lang-go"><span class="pln">func main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L9"><code class="lang-go"><span class="pln">    fmt</span><span class="pun">.</span><span class="typ">Printf</span><span class="pun">(</span><span class="str">"DEBUG is %q\n"</span><span class="pun">,</span><span class="pln"> DEBUG</span><span class="pun">)</span></code></li><li class="L0"><code class="lang-go"><span class="pun">}</span></code></li></ol></pre>
<p>ä½¿ç”¨ldflagsåŠ¨æ€æ³¨å…¥ï¼š</p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code><span class="pln">go build </span><span class="pun">-</span><span class="pln">ldflags </span><span class="str">'-X main.DEBUG=YES'</span><span class="pln"> test</span><span class="pun">.</span><span class="pln">go</span></code></li></ol></pre>
                    </div>
                </div>
                <div class="ui divider"></div>
                
                <a class="ui tiny tag label" style="margin: 2px 5px 2px 5px" href="/tag/go">go</a>
                
            </div>
            
            <div class="ui raised segment" style="margin-left: 2%">
                <a class="ui teal ribbon label">2016-03-28</a>
                <a style="font-size: x-large;font-weight: 800;vertical-align: middle" href="/topic/33">å…¬é’¥ å¯†é’¥ è¯ä¹¦æ•´ç†</a>
                <div class="ui divider"></div>
                <div class="editormd-view" id="33">
                    <div class="abstract">
                        <p>â€” ç”Ÿæˆ RSA ç§é’¥ï¼ˆå¸¦å¯†ç çš„ï¼‰<br>openssl genrsa -des3 -out rsa_private_key.pem 2048
</p><p>â€” ç”Ÿæˆ RSA ç§é’¥ï¼ˆä¼ ç»Ÿæ ¼å¼çš„ï¼‰</p>
<p>openssl genrsa -out rsa_private_key.pem 2048</p>
<p>â€” å°†ä¼ ç»Ÿæ ¼å¼çš„ç§é’¥è½¬æ¢æˆ PKCS#8 æ ¼å¼çš„</p>
<p>openssl pkcs8 -topk8 -inform PEM -in rsa_private_key.pem -outform PEM -nocrypt</p>
<p>â€” ç”Ÿæˆ RSA å…¬é’¥</p>
<p>openssl rsa -in rsa_private_key.pem -pubout -out rsa_public_key.pem</p>
<p>â€” è¯ä¹¦è¯·æ±‚ï¼ˆå¯æ‹¿åˆ°ç¬¬ä¸‰æ–¹è¿›è¡Œç­¾åï¼‰<br>openssl req â€“new -x509 -key rsa_private_key.pem -out server.pem
</p><p>â€” è‡ªç­¾åè¯ä¹¦<br>openssl req -new -x509 -key rsa_private_key.pem -out ca.pem -days 1095
</p>
                    </div>
                </div>
                <div class="ui divider"></div>
                
                <a class="ui tiny tag label" style="margin: 2px 5px 2px 5px" href="/tag/%e6%9c%aa%e5%88%86%e7%b1%bb">æœªåˆ†ç±»</a>
                
            </div>
            
            <div class="ui raised segment" style="margin-left: 2%">
                <a class="ui teal ribbon label">2016-03-01</a>
                <a style="font-size: x-large;font-weight: 800;vertical-align: middle" href="/topic/32">æ•°æ®å­—å…¸å¯¼å‡ºå¤‡å¿˜</a>
                <div class="ui divider"></div>
                <div class="editormd-view" id="32">
                    <div class="abstract">
                        <p>é‡åˆ°éœ€è¦å¯¼å‡ºæ•°æ®å­—å…¸çš„æƒ…å†µï¼ŒPowerDesignçš„å¯¼å‡ºæ–¹å¼ä¸å†ç»†è¡¨ã€‚å…¶å®åœ¨æœ‰å¤‡æ³¨çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥ä»æ•°æ®åº“ä¸­å¯¼å‡ºç›¸åº”çš„å­—å…¸ã€‚</p>
<pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums"><li class="L0"><code class="lang-sql"><span class="pln">SELECT  A</span><span class="pun">.</span><span class="pln">TABLE_NAME AS </span><span class="str">"è¡¨å"</span><span class="pun">,</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">COLUMN_NAME AS </span><span class="str">"å­—æ®µå"</span><span class="pun">,</span><span class="pln"> </span></code></li><li class="L1"><code class="lang-sql"><span class="pln">DECODE</span><span class="pun">(</span><span class="pln">A</span><span class="pun">.</span><span class="pln">CHAR_LENGTH</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> DECODE</span><span class="pun">(</span><span class="pln">A</span><span class="pun">.</span><span class="pln">DATA_SCALE</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">,</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">DATA_TYPE</span><span class="pun">,</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">DATA_TYPE</span><span class="pun">||</span><span class="str">'('</span><span class="pun">||</span><span class="pln">A</span><span class="pun">.</span><span class="pln">DATA_PRECISION</span><span class="pun">||</span><span class="str">','</span><span class="pun">||</span><span class="pln">A</span><span class="pun">.</span><span class="pln">DATA_SCALE</span><span class="pun">||</span><span class="str">')'</span><span class="pun">),</span></code></li><li class="L2"><code class="lang-sql"><span class="pln">A</span><span class="pun">.</span><span class="pln">DATA_TYPE</span><span class="pun">||</span><span class="str">'('</span><span class="pun">||</span><span class="pln">A</span><span class="pun">.</span><span class="pln">CHAR_LENGTH</span><span class="pun">||</span><span class="str">')'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> </span><span class="str">"å­—æ®µç±»å‹"</span><span class="pun">,</span><span class="pln">A</span><span class="pun">.</span><span class="pln">DATA_DEFAULT AS </span><span class="str">"é»˜è®¤å€¼"</span><span class="pun">,</span></code></li><li class="L3"><code class="lang-sql"><span class="pln">A</span><span class="pun">.</span><span class="pln">NULLABLE AS </span><span class="str">"èƒ½å¦ä¸ºç©º"</span><span class="pun">,</span><span class="pln"> B</span><span class="pun">.</span><span class="pln">comments AS </span><span class="str">"å¤‡æ³¨"</span></code></li><li class="L4"><code class="lang-sql"><span class="pln">FROM sys</span><span class="pun">.</span><span class="pln">user_tab_columns A</span><span class="pun">,</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">user_col_comments B</span></code></li><li class="L5"><code class="lang-sql"><span class="pln">WHERE A</span><span class="pun">.</span><span class="pln">table_name</span><span class="pun">=</span><span class="pln">B</span><span class="pun">.</span><span class="pln">table_name AND A</span><span class="pun">.</span><span class="pln">COLUMN_NAME</span><span class="pun">=</span><span class="pln">B</span><span class="pun">.</span><span class="pln">COLUMN_NAME AND A</span><span class="pun">.</span><span class="pln">TABLE_NAME IN </span><span class="pun">(</span><span class="kwd">select</span><span class="pln"> table_name </span><span class="kwd">from</span><span class="pln"> user_tables</span><span class="pun">)</span></code></li><li class="L6"><code class="lang-sql"><span class="pln">ORDER BY A</span><span class="pun">.</span><span class="pln">TABLE_NAME</span></code></li></ol></pre>

                    </div>
                </div>
                <div class="ui divider"></div>
                
                <a class="ui tiny tag label" style="margin: 2px 5px 2px 5px" href="/tag/sql">sql</a>
                
            </div>
            
            <div class="ui raised segment" style="margin-left: 2%">
                <a class="ui teal ribbon label">2016-02-26</a>
                <a style="font-size: x-large;font-weight: 800;vertical-align: middle" href="/topic/31">go reflect åå°„æ¢ç©¶</a>
                <div class="ui divider"></div>
                <div class="editormd-view" id="31">
                    <div class="abstract">
                        <blockquote>
<p>åå°„åœ¨è®¡ç®—æœºçš„æ¦‚å¿µé‡Œæ˜¯æŒ‡ä¸€æ®µç¨‹åºå®¡æŸ¥è‡ªèº«ç»“æ„çš„èƒ½åŠ›ï¼Œä¸»è¦é€šè¿‡ç±»å‹è¿›è¡Œå®¡æŸ¥ã€‚å®ƒæ˜¯å…ƒç¼–ç¨‹çš„ä¸€ç§å½¢å¼ï¼ŒåŒæ ·ä¹Ÿæ˜¯å¼•èµ·æ··ä¹±çš„é‡å¤§æ¥æºã€‚</p>
</blockquote>
<p>ä½†åŒæ—¶ï¼Œåˆç†åˆ©ç”¨åå°„ä¹Ÿä¸ºæˆ‘ä»¬ç¼–ç¨‹æä¾›äº†éå¸¸çµæ´»çš„æ“ä½œæ–¹å¼åŠtrickï¼Œè®©ç¨‹åºæ›´å¥½çš„è¿è¡Œã€‚<br>
                    </div>
                </div>
                <div class="ui divider"></div>
                
                <a class="ui tiny tag label" style="margin: 2px 5px 2px 5px" href="/tag/go">go</a>
                
                <a class="ui tiny tag label" style="margin: 2px 5px 2px 5px" href="/tag/reflect">reflect</a>
                
            </div>
            
            <div class="ui raised segment" style="margin-left: 2%">
                <a class="ui teal ribbon label">2016-02-24</a>
                <a style="font-size: x-large;font-weight: 800;vertical-align: middle" href="/topic/30">gRPCå®æˆ˜</a>
                <div class="ui divider"></div>
                <div class="editormd-view" id="30">
                    <div class="abstract">
                        <h4 id="h4-grpc-google-protobuf-http-2-rpc-"><a name="gRPC æ˜¯Googleå‡ºå“çš„ä¸€æ¬¾åŸºäº  Protobuf ä¸HTTP/2çš„é«˜æ€§èƒ½å¼€æºRPCé€šä¿¡æ¡†æ¶ã€‚" class="reference-link"></a><span class="header-link octicon octicon-link"></span><a href="http://www.grpc.io" title="gRPC">gRPC</a>æ˜¯Googleå‡ºå“çš„ä¸€æ¬¾åŸºäº<a href="https://developers.google.com/protocol-buffers/" title="Protobuf">Protobuf</a>ä¸HTTP/2çš„é«˜æ€§èƒ½å¼€æºRPCé€šä¿¡æ¡†æ¶ã€‚</h4>
                    </div>
                </div>
                <div class="ui divider"></div>
                
                <a class="ui tiny tag label" style="margin: 2px 5px 2px 5px" href="/tag/go">go</a>
                
            </div>
            
            
<div class="ui tiny buttons center" style="padding-left: 32px">
    
    <div class="ui button disabled">First</div>
    
    
    <div  class="ui button active"  onclick="location.href=&#34;/&#34;">
        1
    </div>
    
    <div  class="ui button"  onclick="location.href=&#34;/?p=2&#34;">
        2
    </div>
    
    <div  class="ui button"  onclick="location.href=&#34;/?p=3&#34;">
        3
    </div>
    
    <div  class="ui button"  onclick="location.href=&#34;/?p=4&#34;">
        4
    </div>
    
    
    <div class="ui button" onclick="location.href=&#34;/?p=4&#34;">End</div>
    
</div>

            
        </div>
    </div>
</div>
<footer class="footer">
        <div class="center" style="text-align: center">
            <a href="https://github.com/elvizlai" target="_blank"><i class="icon big github"></i></a>
            <a href="http://weibo.com/sdrzlyz" target="_blank"><i class="icon big weibo"></i></a>
        </div>
        <div style="color: #999;text-align: center">
            <a style="">Â© 2015 ElvizLai</a>
            
        </div>
</footer>
</body>
</html>
